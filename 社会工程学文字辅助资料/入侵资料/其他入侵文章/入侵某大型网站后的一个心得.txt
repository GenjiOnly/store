
入侵某大型网站后的一个心得

一个大型证券类网站asp的   网站前台，是自己开发的程序，生成html

页面分析一下，发现一条通知，是 notice.asp?id=222

由此可知是用asp系统的。

一、暴博客密码，找不到后台

网站架设了博客系统和一个asp的论坛。

博客是oblog的  这个版本的oblog，有注射漏洞。

手工注入，出来一堆的用户名和密码，然后批量爆后台的用户名和密码。

后台的用户名密码拿到手了，但不知道后台在哪里

实在没有办法了，想想去搞论坛  但这论坛，是修改过了，生成html的，不知道怎么办

一点思路都没有    

二、暴前台密码，找不到后台

那还是回到网站的前台，一切从头开始。

换了一个扫描的工具WebCruiser

从头扫到尾，有5个url被判断为有注入漏洞。

挨个手工验证，

http://www.abcstock.com/display.asp?id=234 and 1=2

防注入

换一个地址 

http://www.abcstock.com/showpic.asp?aid=233&pid=789

输入 and 1=1 正常显示，输入 and 1=2无法显示

打开明小子注入成功，表名叫 admin，密码查一下就出来

后台不知道

三、用暴出的密码，从论坛拿webshell

用admin和爆出来的密码，登录论坛前台，直接上去了，再用这个密码登录后台

后台有一个数据库备份的功能，惊喜不已，直接把 图片马 备份成 dama.asp

连接，显示404，判断，应该是有目录不让写入的原因，换目录备份到  data/dama.asp

连接，成功。拿下webshell

四、意外的提权之路

在webshell查看了一下支持的组件。不支持 wscript.shell

主站，是用mssql2005数据库，dbonwer可以提权  测试了一下，很多组件被删除了。

c d e f 都没有权限 g 盘 可以打开
。
发现到一个 文件名叫 “重要数据说明.rar 下载之

rar压缩，要密码。用网站后台的密码解压成功

里面一堆是 ftp 密码  sa密码  服务器用户名 密码

全部可用  提权都不用了。

五、心得

1、一个站点不行，看看子站点有没有漏洞；
2、一个扫描工具不行，多换一个；要多充实自己的武器库；
3、要提权之前，先找一下有没有可以利用的信息；
4、服务器安全上，一定不要各个系统都用同样的密码，不然会很惨
5、重要的密码那些文件，不要放在服务器上


