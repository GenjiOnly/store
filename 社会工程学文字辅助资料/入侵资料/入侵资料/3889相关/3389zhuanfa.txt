当外网3389不能登录时候 也可以考虑用lcx转发  不只是内外才可以转发 外网也可以的

就遇到过外网服务器开了3389连接不上去   lcx转发下就连接上去了

 解决远程桌面无法连接的问题-总结的精华 2011-11-25 22:33:23标签：网络管理 Windows 远程控制 休闲 远程桌面连接 
原创作品，允许转载，转载时请务必以超链接形式标明文章 原始出处 、作者信息和本声明。否则将追究法律责任。http://zhaogao.blog.51cto.com/205189/724690 
    远程桌面连接组件是从Windows 2000 Server开始由微软公司提供的，WINDOWS 2000 SERVER中他不是默认安装的。该组件一经推出受到了很多用户的拥护和喜好，所以在WINDOWS XP和2003中微软公司将该组件的启用方法进行了改革，通过简单的勾选就可以完成在XP和2003下远程桌面连接功能的开启。
      当某台计算机开启了远程桌面连接功能后我们就可以在网络的另一端控制这台计算机了，通过远程桌面功能我们可以实时的操作这台计算机，在上面安装软件，运行程序，所有的一切都好像是直接在该计算机上操作一样。这就是远程桌面的最大功能，通过该功能网络管理  远程桌面连接员可以在家中安全的控制单位的服务器，而且由于该功能是系统内置的所以比其他第三方远程控制工具使用更方便更灵活。
   上面我们对这个工具介绍完毕了，我们还是言归正传谈谈远程桌面在使用过程中的遇到的一些问题吧。
 1、中断远程桌面连接客户端无法建立跟远程计算机的连接。
导致这个错误的可能的原因是:
1) 远程计算机上的远程连接可能没有启用。
2) 已超出远程计算机上的连接最大数。
3) 建立连接时出现了一个网络错误
具体的解决办法：
有时候是这个错误提示：由于网络错误，连接被中断，请重新连接到远程计算机；远程连接我肯定是开启了的，防火墙里面3389端口也是打开的，并且连接其他的服务器就可以连接上，说明我本机没问题，用扫描软件，扫描了一下这个服务器，显示IP和端口都是存在的，说明这个服务器网络也没问题，实在没办法，只有不断的测试，后来在系统日志里面看到很多条系统错误信息。其中：严重错误“RDP 协议组件 "DATA ENCRYPTION" 在协议流中发现一个错误并且中断了客户端连接。”几经周折得知这是因为Certificate子键负责终端服务通信中数据信息的认证和加密，它一旦被损坏，终端服务的协议组件就会检测到错误，中断客户机与终端服务器之间的通信。导致Certificate子键损坏的原因很多，如管理员安装和卸载某些系统软件、对终端服务参数的不合理配置等。这时我们需要重置该键值中的内容，才能修复终端服务。  
    进入注册表编辑器窗口，展开“HKEY_LOCAL_MA CHINE\ SYSTEM\CurrentCon trolSet\Services\TermService\ Parame ters”，找到名为 “Cer tificate”的子键，将它删除，重新启动XP系统或Windows 2000 Server服务器，系统就会重新生成 “Certificate”子键，这样客户端就能正常连接到终端服务器了。
在终端服务器出现无法连接的问题后，我们首先要判断这是不是网络故障引起的，检测远程客户端和XP系统(Windows 2000 Server服务器)是否能够正常连接到网络；然后就要检查终端服务器的加密级别是否设置过高。排除上述原因后，就有可能是“Certificate”子键损坏了。此外，“HKEY_LOCAL _MACHINE\ SYSTEM\Cur rentControlSet\Services\Term Service\Parameters”下的 “X509 Certificate”和“X509 Certificate ID”损坏了也有可能导致终端服务出现问题，它们的修复方法与“Certificate”子键损坏后的修复方法相同。
 
2、提示“本地计算机客户端访问许可不能升级或更新”的解决方法
1)  打开被控机的注册表编辑器，定位到HKLM\SOFTWARE\Microsoft\MSLicensing。
2)  备份MSLicensing键。
3)  删除MSLicensing键，重启系统。 
 
3、提示“远程计算机已结束连接”
1)  打开被控机的注册表编辑器，定位到HKLM\SYSTEM\ControlSet001\Enum\Root\RDPDR，备份该项；右键单击该项，选择“权限”，为当前登录的用户增添“完全控制”的权限。
2)  新建key文件，将以下内容写入，双击导入注册表后重启计算机即可。
Windows Registry Editor Version 5.00
[HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Enum\Root\RDPDR\0000]
"ClassGUID"="{4D36E97D-E325-11CE-BFC1-08002BE10318}"
"Class"="System"
"HardwareID"=hex(7):52,00,4f,00,4f,00,54,00,5c,00,52,00,44,00,50,00,44,00,52,\
00,00,00,00,00
"Driver"="{4D36E97D-E325-11CE-BFC1-08002BE10318}\\0030"
"Mfg"="(标准系统设备)"
"Service"="rdpdr"
"DeviceDesc"="终端服务器设备重定向器"
"ConfigFlags"=dword:00000000
"Capabilities"=dword:00000000
4、提示“客户端无法连接到远程计算机”。
1)  远程计算机不可到达（ping不通或者被防火墙拦截）
2)  服务器没有开启3389端口（系统属性里“远程”页面里的“远程桌面”未打勾或没有使用有远程登陆权限的用户即可）
3)  terminal services 服务未启动，启动此服务即可,另外还有两个RDP服务也别忘记哦
4)   检查远程桌面是不是被更改了端口，步骤：打开“开始→运行”，输入“regedit”，打开注册表，进入以下路径：[HKEY_LOCAL_MACHINE\SYSTEM\
CurrentControlSet\Control\Terminal Server\Wds\rdpwd\Tds\tcp]，看见PortNamber值了吗？其默认值是3389如果不对请改回来。