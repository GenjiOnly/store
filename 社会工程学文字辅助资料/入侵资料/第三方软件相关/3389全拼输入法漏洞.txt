

3389端口是Windows 2000 Server 远程桌面的服务端口。通过3389端口入侵系统是黑客的最爱，因为通过图形界面，可以像操作本地计算机一样来控制远程计算机。但是如何绕过系统身份验证，进入远程系统却成为了一个关键问题。本文将要提到的方法是利用经典的输入法漏洞，该漏洞存在于Microsoft Windows 2000所有中文版本，可以通过微软提供的补丁程序进行漏洞修复。

　　编注：虽然此漏洞不算什么新鲜事，但是正如经典的商业案例会被载入MBA教程一样，不会被时代所遗忘。而且现在仍然有一些网管因为疏忽或对它重视不够，犯此严重错误。作为初学者，你必须认识并完全掌握它。只有对基础知识有了全面的了解，你才有进阶的资本。

　　Step1：备好攻城锤

　　获取终端服务软件

　　网站cp.feedom.net开启了3389终端服务，前面讲过这是一个方便用户管理的远程连接服务。我们可以通过微软开发的管理软件来对服务器进行远程管理（Windows XP系统已经自带）。该软件可以到http://www.bitscn.com/upload/TS.rar下载得到。

　　Step2：短兵相接

　　连接远程服务器

　　这是一款绿色软件，解压后双击mstsc.exe执行文件即可使用。在出现的如图1所示的界面中，“计算机”是你要远程控制的服务器的名称，我们在这里输入本栏目提供的服务器域名cp.feedom.net。点击“连接”，屏幕上将出现Windows 2000的登录画面。



图 1

 

Step3：长驱直入 
 

　　绕过系统身份验证并获取管理员权限

　　这一步操作是很多初学者最难理解和完成的，下面听笔者细细道来。

　　1．按“Ctrl+Shift”组合键，快速切换至全拼输入法，这时在登录界面左下角将出现输入法状态条。如果没有出现，就有两种可能：

　　1） 时间问题：服务器的数据流传输有一个延时的过程，需要耐心等待。

　　2） 操作问题：如果你将鼠标指针点击在了“密码”旁边的空白栏处，输入法状态条是不会出现的，需要将鼠标点击在“用户名”旁边的空白栏。

　　2．用鼠标右键点击状态条上的微软徽标，选取“帮助”中的“操作指南”，在“输入法操作指南”的左上角点击鼠标右键，在弹出的菜单中选择“跳至URL(J)…”。接下来你将会看到Windows 2000的系统安装路径和要求填入路径的窗口。

　　编注：在实战当中，如果发现“帮助”呈灰色，那么肯定是该服务器已经补上这个漏洞了，你需要换用其它方法了。

　　例如在本实例中，系统安装在C盘上，那么就在空白栏中填入C:\WinNT\System32，然后按“确定”，这就成功地绕过了身份验证，进入了系统的System32目录了。

　　3．现在我们要获得一个账号，以成为系统的合法用户。在想办法得到权限之前，大家有必要先了解一下Windows 2000下关于账号的DOS命令：

　　net user username /active :yes（激活一个账号）
　　net user username password（设定账号密码）
　　net user username password /add（添加一个账号）
　　net localgroup localgroupname username /add（添加账号到某个组）

　　以上命令应该清楚了吧，现在让我们来发挥创造性思维。

　　1） 在C:\WinNT\System32目录下找到net.exe，并为net.exe创建一个快捷方式（这个不用笔者教了吧-_-），完成之后会在同一目录下多出一个快捷方式的图标来。

　　2） 用鼠标右键点击该快捷方式的图标，选取“属性”，在“目标”中的c:\winnt\system32\net.exe后面空一格，填入user guest /active :yes，点击“确定”（图2）。



图 2

　　3）上一步的目的在于用net.exe激活被禁止使用的guest账号。当然也可以填入“user 用户名 密码 /add”来创建一个新账号，不过莫明多出一个账户在实战当中容易引起网管的注意，导致入侵失败，此法实不可取。

　　4）双击运行该快捷方式，不要奇怪你没有看到运行状态，因为实际上guest账户已被激活了。现在需要再修改该快捷方式，填入“user guest 密码”点击“确定”。双击运行该快捷方式，现在guest账号已经有密码了。

　　5）最后我们要将guest账号加入到管理员组中，使之成为名副其实的系统管理员。再对它进行修改，填入“localgroup administrators guest /add”，然后点击“确定”，双击运行该快捷方式。

　　注意：

　　1．因为受到网速的影响，你所看到的图像与操作会有所延迟。

　　2．由于连接服务器的用户过多，在连接登录服务器的过程中，你有可能会遇到“超过了允许最大连接数”的提示。如果是这样请稍后再试 
。

　　Step4：完全占领

　　控制服务器“肉鸡”

　　通过上面的操作，我们已经得到了一个系统管理员账号。接下来要想控制这台服务器就好办多了。打开远程终端管理程序，在登录画面出现后，填入用户名guest和你设的密码，点击“连接”，现在你看到什么了？对！这台服务器就是你的了。

本文来源：华西安全网[http://www.hx99