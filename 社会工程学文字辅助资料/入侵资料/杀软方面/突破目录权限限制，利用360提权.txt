突破目录权限限制，利用360提权


得一WebShell，目录权限设置很严，

C:\progra~1\无权限访问，
C:\Docume~1\AllUse~1\Documents\目录有可写可读权限，

运行CMD，是2003系统，

tasklist查看运行程序，有360安全卫士的，

上传360漏洞利用程序，结果失败！提示没有安装360.

但是我利用注册表读取可以得知，导致360漏洞的注册表驱动仍然没有被卸载掉，肯定是可以利用的。

虽然360有自动升级功能，会自动上了补丁，但补丁只有重启后才起作用。像服务器这种几个月才重启一次的危险性很大！

问题就在对C:\progra~1\目录及子目录没有访问权。

网上流传的360漏洞利用程序需要利用

C:\Program Files\360safe\deepscan\目录下（360安装目录）的BREGDLL.dll导出的注册表操作函数

既然不能访问C:\Program Files\360safe\deepscan\的dll文件，但是我可以上传一个BREGDLL.dl到我可以访问的目录里。

于是我在本机提取一个360的BREGDLL.dll文件，上传到C:\Docume~1\AllUse~1\Documents\

好了，现在需要编写一个360利用程序了，让程序直接利用我们上传的BREGDLL.dll中的函数进行注册表操作

编译好后，上传运行，很好，成功了！

应该是得了一个shift后门了。

3389登录，shift！！！！！！！

登录后发现原来装了Plesk，C:\Program Files\是这样设置的，所有IIS_USER访问权限都设置为拒绝！

