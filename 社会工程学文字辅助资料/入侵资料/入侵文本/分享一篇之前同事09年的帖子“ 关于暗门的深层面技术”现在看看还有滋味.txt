D0000D发往论坛板块-------------------------------------------------------
No2  号板块  技术文章
D8888D贴子标题-------------------------------------------------------
分享一篇之前同事09年的帖子“ 关于暗门的深层面技术”现在看看还有滋味
D8888D主贴内容-------------------------------------------------------
 

horse_b
2009-04-10
                                              
1。普通反向暗门
   现在目前基于反向连接的暗门，基于协议穿透的有
   A。SVCHOST服务的穿透的
   B。应用钩子的穿透
   C。驱动型的NDIS穿透的
   D。假冒IP和MAC
   
   隐藏保护功能
   A。隐藏服务
   B。隐藏进程
   C。隐藏驱动
   D。隐藏文件
   E。隐藏注册表
   F。隐藏驱动器
   G。隐藏连接 
  （这些隐藏功能能突破icesword等的查找）
  
   多进程保护也是一个办法
2。正向木马
   目前有
   A。外网建DDNS SERVER，把内网的主机端口映射出来（一般是基于连接）
   B。专门正对服务器的，正向端口，利用特殊办法端口复用的
   C。不需要开端口的SNIFFER型的暗门，一般是RAW PACKET的
   
   隐藏保护功能
   A。隐藏服务
   B。隐藏进程
   C。隐藏驱动
   D。隐藏文件
   E。隐藏注册表
   F。隐藏驱动器
   G。隐藏连接 
  （这些隐藏功能能突破icesword等的查找）
  
3。特殊PE嵌入式后门
目前有
A。写在SVCHOST。EXE等主要服务程序里的PE后门，有防止升级后服务被替换的保护功能，有协议穿透功能
B。有替换微软硬链接的PE后门，这些硬链接是微软启动的时候加载的
C。加入少量的特殊指令的暗门病毒，有反跟踪和反调试的能力
一般不需要隐藏保护
4。虚拟机后门
A。写入WINDOWS启动前的分区，自动引导WINDOWS起来的，靠分析NTFS，FAT，和内存过日子的虚拟机后门，比较厉害,一般是国家机构搞的
B。一般的小虚拟机后门很难模拟协议栈，不是太实用
一般不需要隐藏保护
5。小系统病毒
特殊功能的小马，一些特殊机构用的后门，突破一切主机联网和突破一切主动防御功能，这里不用多讲了。一般没必要这么做的
6。纯应用层后门和病毒
我网站上有后门的例子，在ww.horseb.org/luanqibazao.html上，安装过后把木马文件删除，只在内存中存在，在USER用户条件下也能发作的病毒，特殊方式启动的，不操作Administrators权限的东西，没有驱动
7。硬件启动后门
部分硬件有写功能，写入硬件部分后门启动部分，开机引导后门加载
8。硬件API不可读的部分放入小病毒，随时释放到硬盘或是内存中的硬件病毒
一般是部分国家机构搞的病毒
9。特殊P2P后门病毒
这些特殊的P2P后门，一些黑客组织也在做，一些国家组织也在做，未来的协议后门的发展方向，是将来的国家暗门
10。一些玩具后门
一些黑客小孩做的小暗门，一般逃不过检测
11。突破病毒和主动防御的后门
现在好多后门努力追求逃过主动防御，一般的方法有
A。RESTORE SSDT
B。KILL 杀毒软件
C。特殊加壳
D。高级驱动保护
E。钩坏杀毒软件
12.RAW PACKET 后门
  这种东西很多，也比较老，正向的反向的RAW PACKET后门一度比较流行，现在也很多，另外还有一些利用错误协议报的暗包后门，还有小暗包后门，都被归到这种
